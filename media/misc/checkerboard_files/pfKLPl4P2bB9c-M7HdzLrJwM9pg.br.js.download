var InfoBubble;(function(n){function k(n){Lib.CssClass.remove(n,"b_hide")}function d(n){Lib.CssClass.add(n,"b_hide")}function g(n,t,i){var r=(new Date).getTime();!t||i||l!==null&&r-l<ct?Lib.CssClass.add(n,"infobubble_showNoDelay"):Lib.CssClass.add(n,"infobubble_fadeIn");sj_evt.fire("infobubble_show",n)}function a(n){Lib.CssClass.remove(n,"infobubble_showNoDelay");Lib.CssClass.remove(n,"infobubble_fadeIn")}function v(n){var t=n.getBoundingClientRect();return new w(t.left,t.top,t.bottom-t.top,t.right-t.left)}function nt(n){Lib.CssClass.remove(n,"ifbb_tri_bottom");Lib.CssClass.add(n,"ifbb_tri_top")}function tt(n){Lib.CssClass.remove(n,"ifbb_tri_top");Lib.CssClass.add(n,"ifbb_tri_bottom")}function it(n){Lib.CssClass.remove(n,"ifbb_tri_right");Lib.CssClass.add(n,"ifbb_tri_left")}function rt(n){Lib.CssClass.remove(n,"ifbb_tri_left");Lib.CssClass.add(n,"ifbb_tri_right")}function at(n){Lib.CssClass.remove(n,"tri_center");Lib.CssClass.remove(n,"tri_right");Lib.CssClass.add(n,"tri_left")}function ut(n){Lib.CssClass.remove(n,"tri_left");Lib.CssClass.remove(n,"tri_right");Lib.CssClass.add(n,"tri_center")}function vt(n){Lib.CssClass.remove(n,"tri_left");Lib.CssClass.remove(n,"tri_center");Lib.CssClass.add(n,"tri_right")}function yt(n){Lib.CssClass.remove(n,"tri_middle");Lib.CssClass.remove(n,"tri_bottom");Lib.CssClass.add(n,"tri_top")}function pt(n){Lib.CssClass.remove(n,"tri_top");Lib.CssClass.remove(n,"tri_bottom");Lib.CssClass.add(n,"tri_middle")}function wt(n){Lib.CssClass.remove(n,"tri_top");Lib.CssClass.remove(n,"tri_middle");Lib.CssClass.add(n,"tri_bottom")}function bt(n){Lib.CssClass.remove(n,"ifbb_tri_top");Lib.CssClass.remove(n,"ifbb_tri_bottom");Lib.CssClass.remove(n,"ifbb_tri_left");Lib.CssClass.remove(n,"ifbb_tri_right");Lib.CssClass.remove(n,"tri_left");Lib.CssClass.remove(n,"tri_right");Lib.CssClass.remove(n,"tri_top");Lib.CssClass.remove(n,"tri_bottom");n.style.top="";n.style.right="";n.style.bottom="";n.style.left="";n.style.width=""}function ft(){return _w.innerHeight||_d.documentElement.clientHeight||_d.body.clientHeight}function et(){return _w.innerWidth||_d.documentElement.clientWidth||_d.body.clientWidth}function e(n){return n+_w.pageYOffset}function kt(n){return _d.body.scrollWidth>et()&&(n-=ht),n-_w.pageYOffset}function o(n){return n+_w.pageXOffset}function dt(n){return _d.body.scrollHeight>ft()&&(n-=st),n-_w.pageXOffset}function gt(){var n=sj_ce("div"),i,t,r;return n.style.visibility="hidden",n.style.width="100px",_d.body.appendChild(n),i=n.offsetWidth,n.style.overflow="scroll",t=sj_ce("div"),t.style.width="100%",n.appendChild(t),r=t.offsetWidth,_d.body.removeChild(n),i-r}function ni(){var n=sj_ce("div"),i,t,r;return n.style.visibility="hidden",n.style.height="100px",_d.body.appendChild(n),i=n.offsetHeight,n.style.overflow="scroll",t=sj_ce("div"),t.style.height="100%",n.appendChild(t),r=t.offsetHeight,_d.body.removeChild(n),i-r}function ti(n,t,i,r,u,f,e,o,s,c){if(!h[n]){var l=new lt(n,t,i,r,u,f,e,o,s,c);h[n]=l}}function ii(n,t,r,u,f,e,o,s,h,c,l,a,v,y,p,w,k,d,g){var nt=function(n,t,r,u,f,e,o,s,h,c,l,a,v,y,p,w,k,d,g){if(!i[n]){var nt=new b(n,t,r,u,f,e,o,s,h,c,l,a,v,y,p,w,k,d,g);i[n]=nt;sj_evt.fire(n+"_ready")}},tt=[n,t,r,u,f,e,o,s,h,c,l,a,v,y,p,w,k,d,g],it=_ge(n);typeof SmartRendering!="undefined"?SmartRendering.LoadElementWhenDisplayed(this,it,nt,tt):nt.apply(this,tt)}function ri(n,t){t===void 0&&(t=!0);i[n]&&i[n].setFocus(t)}function ot(n){return i[n]&&i[n].getStatus()===t.Shown}function ui(n,t){if(t===void 0&&(t=!0),ot(n))return i[n].hide(!0,t),!0;return!1}var r=8,f=16,c=20,y=50,s=14,st=gt(),ht=ni(),ct=300,p=12,h=[],i=[],l=null,w=function(){function n(n,t,i,r){this.left=n;this.top=t;this.height=i;this.width=r}return n}(),lt=function(){function n(n,t,i,r,u,f,e,o,s,h){(this.id=n,this.bubbleId=t,this.node=_ge(n),this.anchor=_ge(i),this.node&&_ge(this.bubbleId))&&(this.anchor==null&&(this.anchor=this.node),this.init(r,u,f,e,o,s,h))}return n.prototype.getAnchorLocation=function(){return v(this.anchor)},n.prototype.hideBubbles=function(){for(var n in i)i.hasOwnProperty(n)&&i[n].hide(!0)},n.prototype.itemClick=function(){i[this.bubbleId].show(!1);sj_pd(event);sj_sp(event)},n.prototype.cleanShowDelayTimeout=function(){this.showBubbleItemTimeout&&(sb_ct(this.showBubbleItemTimeout),this.showBubbleItemTimeout=null)},n.prototype.init=function(n,t,r,u,f,e,o){var s=this;n&&(f?sj_evt.bind(this.id+"_click",function(){sj_evt.bind(s.bubbleId+"_ready",function(){s.itemClick()},!0)},!0):sj_be(this.node,"click",function(){s.itemClick()}));t&&(sj_be(this.node,"mouseenter",function(){if(e&&e>0){s.cleanShowDelayTimeout();var n=s;s.showBubbleItemTimeout=sb_st(function(){i[n.bubbleId].show(!0,o)},e)}else i[s.bubbleId].show(!0,o)}),sj_be(this.node,"keyup",function(n){if(n.keyCode==9)if(e&&e>0){s.cleanShowDelayTimeout();var t=s;s.showBubbleItemTimeout=sb_st(function(){i[t.bubbleId].show(!1,o)},e)}else i[s.bubbleId].show(!1,o)}));r&&(sj_be(this.node,"click",function(n){for(var t in i)i.hasOwnProperty(t)&&t!=s.bubbleId&&i[t].hide(!0);sj_sp(n)}),sj_evt.bind("slideexp_movestart",this.hideBubbles));u&&sj_be(this.node,"mouseleave",function(){s.cleanShowDelayTimeout();i[s.bubbleId].hide()});u&&(sj_be(this.node,"keydown",function(n){n.keyCode==27&&i[s.bubbleId].hide()}),sj_be(this.node,"focusout",function(n){var u=sj_ev(n),t=u.relatedTarget,r=_ge(s.bubbleId);t!==null&&(s.node.contains(t)||r==null||r.contains(t))||i[s.bubbleId].hide()}))},n}(),t,u,b;(function(n){n[n.Hidden=0]="Hidden";n[n.Showing=1]="Showing";n[n.Shown=2]="Shown";n[n.Hiding=3]="Hiding"})(t||(t={})),function(n){n[n.Top=0]="Top";n[n.Right=1]="Right";n[n.Bottom=2]="Bottom";n[n.Left=3]="Left"}(u||(u={}));b=function(){function n(n,i,r,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){var nt,tt;(this.triangleHorizontalPlacingOrder=[0,-1,1],this.triangleVerticalPlacingOrder=[0,-1,1],this.state=t.Hidden,this.timerId=-1,this.actualWidth=0,this.actualHeight=0,this.hideOnlyByClick=!1,this.id=n,this.itemId=i,this.locatorId=r,this.width=f,this.padding=e,this.border=o,this.anchorVerticalOffsetPixel=s,this.extraWidth=e+this.border,this.enableOverlay=c,this.enableFullWidth=l,this.enableUnfixedTriangle=a,this.enableBubbleHeader=v,this.enableClickOutsideToClose=y,this.enableHoverOutsideToClose=p,this.enableDynamicWidth=w,this.disableInitialFocus=b,this.toolTipMaxWidth=k,this.showBubbleWithNoFadeInWhenHover=d,this.disableListenFocusEvent=g,this.node=_ge(n),this.node)&&(nt=v?1:0,this.beforeNode=this.node.children[nt],this.closeNode=this.node.children[nt+1],this.content=this.node.children[nt+2],this.afterNode=this.node.children[nt+3],this.locatorNode=_ge(this.locatorId),this.locatorNode&&this.locatorNode.appendChild(this.node),this.appns=this.node.getAttribute("data-appns"),this.k=this.node.getAttribute("data-k"),this.infoBubblePosition=this.getPosition(this.node.getAttribute("data-ibp")),tt=this.getPosition(this.node.getAttribute("data-trp")),this.infoBubblePosition==u.Left||this.infoBubblePosition==u.Right?tt==u.Top?this.triangleVerticalPlacingOrder=[1,0,-1]:tt==u.Bottom&&(this.triangleVerticalPlacingOrder=[-1,0,1]):tt==u.Left?this.triangleHorizontalPlacingOrder=[-1,0,1]:tt==u.Right&&(this.triangleHorizontalPlacingOrder=[1,0,-1]),this.init(h))}return n.prototype.getPosition=function(n){return n==="top"?u.Top:n==="right"?u.Right:n==="bottom"?u.Bottom:n==="left"?u.Left:void 0},n.prototype.getStatus=function(){return this.state},n.prototype.show=function(n,i){switch(this.state){case t.Hidden:this.state=t.Showing;this.showBubble(n);break;case t.Hiding:sb_ct(this.timerId);g(this.node,n,i);this.state=t.Shown}},n.prototype.hide=function(n,i){var r=this;if(n===void 0&&(n=!1),i===void 0&&(i=!1),!this.hideOnlyByClick||n)switch(this.state){case t.Showing:this.state=t.Hidden;a(this.node);break;case t.Shown:this.state=t.Hiding;n?this.hideBubble(i):this.timerId=sb_st(function(){a(r.node);l=(new Date).getTime();r.timerId=sb_st(function(){r.hideBubble(i)},y)},y);break;case t.Hiding:n&&(sb_ct(this.timerId),this.hideBubble(i))}},n.prototype.setFocus=function(n,t){var u=this,i,r;n===void 0&&(n=!0);t===void 0&&(t=!1);n&&AccessibilityHelpers.focusFirstFocusableElementWithin(this.node);i=AccessibilityHelpers.getFocusableElementWithin(this.node);r=AccessibilityHelpers.getFocusableElementWithin(this.node,!0);t||i==null||this.firstChildNode!=null||sj_be(this.node,"focusin",function(n){u.show(!1,!1);sj_sp(n)});t||i==null||i==this.firstChildNode||(this.firstChildNode=i,sj_be(this.firstChildNode,"focusout",function(n){u.hide();sj_sp(n)}));t||r==null||r==i||r==this.lastChildNode||(this.lastChildNode=r,sj_be(this.lastChildNode,"focusout",function(n){u.hide();sj_sp(n)}))},n.prototype.init=function(n){var t=this;if(this.enableFullWidth&&Lib.CssClass.add(this.node,"fullwidth"),this.enableOverlay&&(this.overlayNode=sj_ce("div",null,"infobubble_overlay"),sj_be(this.overlayNode,"click",function(){t.hide(!0)})),sj_be(this.closeNode,"click",function(){t.hide(!0,!0)}),sj_be(this.closeNode,"keydown",function(n){(n.keyCode===13||n.keyCode===32)&&(sj_pd(n),t.hide(!0,!0))}),this.enableOverlay||(sj_be(this.node,"mouseenter",function(){t.show(!0,t.showBubbleWithNoFadeInWhenHover)}),this.enableClickOutsideToClose&&(sj_be(this.node,"click",function(n){sj_sp(n)}),sj_be(_d.body,"click",function(){t.hide(!0);sj_evt.fire("bubble_clickOutsideToClose",t.id)})),this.enableHoverOutsideToClose&&sj_be(this.node,"mouseleave",function(){var n=!Lib.CssClass.contains(t.closeNode,"b_hide");n?t.hide():t.hide(!0)})),n&&sj_evt.bind("onP1",function(){t.hideOnlyByClick=!0;t.show(!1,!1)},!0),typeof Orientation!="undefined")Orientation.onOrientation(function(n){t.onOrientation(n)});sj_evt.bind("infobubble_customshow",function(n){n==null||n.length<=1||t.id!==n[1]||(t.hideOnlyByClick=!0,t.show(!1,!1))},!0)},n.prototype.getRenderedDimensions=function(n){var t=this.node,f=t.style.whiteSpace,i,r,u;return t.style.visibility="hidden",t.style.top="-5000px",n===0?t.style.whiteSpace="nowrap":t.style.width=n+"px",i=!Lib.CssClass.contains(t,"b_hide"),k(t),_d.body.appendChild(t),r=t.offsetHeight,u=t.offsetWidth+1,_d.body.removeChild(t),i||d(t),t.style.width="",t.style.top="",t.style.visibility="",n===0&&(t.style.whiteSpace=f),new w(0,0,r,u)},n.prototype.getBubbleHeight=function(n){return this.getRenderedDimensions(n).height},n.prototype.showBubble=function(n){var i=this,r;if(this.state==t.Showing){if(r=this.placeAround(h[this.itemId].getAnchorLocation()),!r){this.state=t.Hidden;return}this.enableOverlay&&_d.body.appendChild(this.overlayNode);this.locatorNode||_d.body.appendChild(this.node);k(this.node);sb_st(function(){g(i.node,n,i.showBubbleWithNoFadeInWhenHover)},20);this.state=t.Shown;n&&this.disableInitialFocus||sb_st(function(){i.setFocus(!0,i.disableListenFocusEvent)},20);sj_evt.fire("infobubble_show_log",this.node);Log.Log("Show","InfoBubble",this.id,!1,"AppNS",this.appns,"K",this.k,"Category","CommonControls")}},n.prototype.hideBubble=function(n){if(n===void 0&&(n=!0),this.state==t.Hiding){a(this.node);d(this.node);this.locatorNode||this.node&&this.node.parentNode&&this.node.parentNode.removeChild(this.node);this.enableOverlay&&this.overlayNode&&this.overlayNode.parentNode&&this.overlayNode.parentNode.removeChild(this.overlayNode);this.resetBubble();this.state=t.Hidden;var i=_ge(this.itemId);i&&n&&AccessibilityHelpers.focusFirstFocusableElementWithin(i);sj_evt.fire("infobbuble_hide ",this.node);Log.Log("Hide","InfoBubble",this.id,!1,"AppNS",this.appns,"K",this.k,"Category","CommonControls")}},n.prototype.resetBubble=function(){bt(this.node);this.beforeNode.style.left="";this.afterNode.style.left="";this.beforeNode.style.top="";this.afterNode.style.top=""},n.prototype.onOrientation=function(){this.state==t.Shown&&(this.resetBubble(),this.placeAround(h[this.itemId].getAnchorLocation()))},n.prototype.placeAround=function(n){if(this.locatorNode)return this.infoBubblePosition==u.Left||this.infoBubblePosition==u.Right?this.placeInHorizontal(this.locatorNode,n):this.placeInVertical(this.locatorNode,n);var t=et(),i=ft();if(this.actualWidth=this.getActualWidth(t),this.actualHeight=this.getBubbleHeight(this.actualWidth),this.enableBubbleHeader&&!this.enableFullWidth)return this.placeAroundWithHeader(n,t);if(this.infoBubblePosition==u.Left||this.infoBubblePosition==u.Right)if(this.placeInfoBubbleHorizontal(n.left,n.width,t))this.placeTriangleVertical(n.top,n.height,i);else return!1;else this.placeInfoBubbleVertical(n.top,n.height,i),this.placeTriangleHorizontal(n.left,n.width,t);return!0},n.prototype.placeAroundWithHeader=function(n,t){var u=e(Math.max(0,n.top-(this.actualHeight-n.height)/2)),i=o(n.left+n.width+r);return i+this.actualWidth<t?(this.node.style.top=u+"px",this.node.style.left=i+"px",this.node.style.width=this.actualWidth+"px",Lib.CssClass.add(this.node,"chevron_left"),!0):!1},n.prototype.placeInVertical=function(n,t){var u=v(n),i;return u.top>=t.top+t.height?(nt(this.node),u.top-r<t.top+t.height&&(this.node.style.top=r+"px")):(tt(this.node),this.node.style.bottom=u.top+u.height+r>t.top?r+"px":"0"),i=t.width/2-f/2,i+=t.left-u.left,i<0?i=0:i>u.width-f&&(i=u.width-f),this.beforeNode.style.left=i+"px",this.afterNode.style.left=i+"px",!0},n.prototype.placeInHorizontal=function(n,t){var u=v(n),i;return u.left>=t.left+t.width?(it(this.node),u.left-r<t.left+t.width&&(this.node.style.left=r+"px")):(rt(this.node),this.node.style.right=u.left+u.width+r>t.left?r+"px":"0"),i=t.height/2-f/2,i+=t.top-u.top,i<0?i=0:i>u.height-f&&(i=u.height-f),this.beforeNode.style.top=i+"px",this.afterNode.style.top=i+"px",!0},n.prototype.getActualWidth=function(n){var t=this.width;return this.enableDynamicWidth&&(t=this.getRenderedDimensions(0).width,t>this.toolTipMaxWidth&&(t=this.toolTipMaxWidth),t=t-2*this.extraWidth),this.enableFullWidth?n-2*this.extraWidth-2*c:(t+2*this.extraWidth)*1.5>n?n/1.5-2*this.extraWidth:t},n.prototype.placeInfoBubbleVertical=function(n,t,i){var f=this.anchorVerticalOffsetPixel>t?t:this.anchorVerticalOffsetPixel,e=i-(n+t)+f,o=n+f;if(this.infoBubblePosition==u.Top){this.actualHeight+2*this.extraWidth+r<o||o>e?this.placeTopInfoBubble(n,f):this.placeBottomInfoBubble(n,t,f);return}this.actualHeight+2*this.extraWidth+r<e||e>o?this.placeBottomInfoBubble(n,t,f):this.placeTopInfoBubble(n,f)},n.prototype.placeInfoBubbleHorizontal=function(n,t,i){var f=this.anchorVerticalOffsetPixel>t?t:this.anchorVerticalOffsetPixel,o=i-(n+t)+f,e=n+f;return this.infoBubblePosition==u.Left&&this.width+2*this.extraWidth+r<e?(this.placeLeftInfoBubble(n,f),!0):this.width+2*this.extraWidth+r<o?(this.placeRightInfoBubble(n,t,f),!0):this.width+2*this.extraWidth+r<e?(this.placeLeftInfoBubble(n,f),!0):!1},n.prototype.placeBottomInfoBubble=function(n,t,i){nt(this.node);this.node.style.top=e(n+t+r-i)+"px"},n.prototype.placeTopInfoBubble=function(n,t){tt(this.node);var i=this.getBubbleHeight(this.actualWidth);this.node.style.top=e(n-i-r+t)+"px"},n.prototype.placeRightInfoBubble=function(n,t,i){it(this.node);this.node.style.left=o(n+t+r-i)+"px"},n.prototype.placeLeftInfoBubble=function(n,t){rt(this.node);var i=this.width+2*this.extraWidth;this.node.style.left=o(n-i-r+t)+"px"},n.prototype.placeTriangleHorizontal=function(n,t,i){var r,u,f,o,e;if(this.node.style.width=this.actualWidth+"px",this.enableFullWidth&&this.enableBubbleHeader){ut(this.node);return}if(this.enableUnfixedTriangle){this.placeUnfixedTriangle(n,t,i);return}for(r=n+t/2,u=this.actualWidth/2+this.extraWidth,f=0,o=this.triangleHorizontalPlacingOrder;f<o.length;f++){if(e=o[f],e==0&&r-u>=0&&r+u<=i){this.placeCenterBubble(n,t,i);return}if(e<0&&n>=u){this.placeLeftBubble(n,t,i);return}if(e>0&&n+t+u<=i){this.placeRightBubble(n,t,i);return}}if(r<i/3){this.placeRightBubble(n,t,i);return}if(r>i/3*2){this.placeLeftBubble(n,t,i);return}this.placeCenterBubble(n,t,i);return},n.prototype.placeTriangleVertical=function(n,t,i){var r,u,f,o,e;if(this.node.style.width=this.enableDynamicWidth?"":this.width+"px",this.enableUnfixedTriangle){this.placeUnfixedTriangle(n,t,i);return}for(r=n+t/2,u=this.actualHeight/2,f=0,o=this.triangleVerticalPlacingOrder;f<o.length;f++){if(e=o[f],e==0&&r-u>=0&&r+u<=i){this.placeMiddleBubble(n,t,i);return}if(e<0&&n>=u){this.placeTopBubble(n,t,i);return}if(e>0&&n+t+u<=i){this.placeBottomBubble(n,t,i);return}}if(r<i/3){this.placeBottomBubble(n,t,i);return}if(r>i/3*2){this.placeTopBubble(n,t,i);return}this.placeMiddleBubble(n,t,i);return},n.prototype.placeUnfixedTriangle=function(n,t,i){var u=n+t/2-c,r=u-f/2;r=Math.max(r,p);r=Math.min(r,i-2*c-f-p);this.beforeNode.style.left=r+"px";this.afterNode.style.left=r+"px"},n.prototype.placeRightBubble=function(n,t){at(this.node);var i=n+t/2,r=f/2+s;this.node.style.left=o(i-r)+"px"},n.prototype.placeCenterBubble=function(n,t){ut(this.node);var i=n+t/2,r=(this.actualWidth+2*this.extraWidth)/2;this.node.style.left=o(i-r)+"px"},n.prototype.placeLeftBubble=function(n,t,i){vt(this.node);var r=i-(n+t/2),u=f/2+s;this.node.style.right=dt(r-u)+"px"},n.prototype.placeBottomBubble=function(n,t){yt(this.node);var i=n+t/2,r=f/2+s;this.node.style.top=e(i-r)+"px"},n.prototype.placeMiddleBubble=function(n,t){pt(this.node);var i=n+t/2,r=this.actualHeight/2;this.node.style.top=e(i-r)+"px"},n.prototype.placeTopBubble=function(n,t,i){wt(this.node);var r=i-(n+t/2),u=f/2+s;this.node.style.bottom=kt(r-u)+"px"},n}();n.initItem=ti;n.initBubble=ii;n.setBubbleFocus=ri;n.isBubbleShowing=ot;n.closeBubble=ui;sj_evt.fire("infobubble_initBubble",n);sj_evt.fire("infobubble_initItem",n)})(InfoBubble||(InfoBubble={}))